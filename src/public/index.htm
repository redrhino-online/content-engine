<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Engine</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.5.10/dist/vuetify.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.5.10/dist/vuetify.min.css" rel="stylesheet">
    <style>
        .responsive-container {
            max-width: 100%;
            margin: 10px auto;
        }

        @media (min-width: 600px) {
            .responsive-container {
                max-width: 60vw;
            }
        }

        .copy-btn {
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div id="app">
        <v-app>
            <v-container class="responsive-container">
                <v-form>
                    <v-row>
                        <v-col cols="12" lg="3" sm="12">
                            <v-select v-model="selectedClient" :items="clients" label="Select Client" item-text="title"
                                item-value="value" @change="loadClientData"></v-select>
                        </v-col>
                        <v-col cols="12" lg="3" sm="12">
                            <v-select v-model="selectedInstruction" :items="instructions" label="Select Instruction"
                                item-text="title" item-value="value" return-object @change="saveSelections"></v-select>
                        </v-col>
                        <v-col cols="12" lg="3" sm="12">
                            <v-select v-model="selectedAudience" :items="audiences" label="Select Audience"
                                item-text="title" item-value="value" return-object @change="saveSelections"></v-select>
                        </v-col>
                        <v-col cols="12" lg="3" sm="12">
                            <v-select v-model="selectedChallenge" :items="challenges" label="Select Challenge"
                                item-text="title" item-value="value" return-object @change="saveSelections"></v-select>
                        </v-col>
                        <v-col cols="12" lg="3" sm="12">
                            <v-select v-model="selectedSymptom" :items="symptoms" label="Select Symptom"
                                item-text="title" item-value="value" return-object @change="saveSelections"></v-select>
                        </v-col>
                    </v-row>

                    <v-row>
                        <v-col cols="12" lg="6" sm="12">
                            <v-select v-model="selectedTone" :items="tones" label="Select Tone" @change="saveSelections"></v-select>
                        </v-col>

                        <v-col cols="12" lg="6" sm="12">
                            <v-select v-model="selectedMood" :items="moods" label="Select Mood" @change="saveSelections"></v-select>
                        </v-col>
                    </v-row>

                    <v-row>
                        <v-col cols="12" class="copy-btn">
                            <v-btn @click="copyToClipboard" color="blue">Copy Prompt</v-btn>
                        </v-col>
                    </v-row>

                    <v-row>
                        <v-col cols="12">
                            <v-btn @click="clearSelections" color="red">Clear All</v-btn>
                        </v-col>
                    </v-row>

                    <v-row>
                        <v-col cols="12">
                            <v-textarea label="Prompt" :value="generatedPrompt" readonly auto-grow></v-textarea>
                        </v-col>
                    </v-row>
                </v-form>
            </v-container>
        </v-app>
    </div>

    <script>
        new Vue({
            el: '#app',
            vuetify: new Vuetify(),
            data() {
                return {
                    selectedAudience: null,
                    selectedChallenge: null,
                    selectedSymptom: null,
                    selectedInstruction: null,
                    selectedTone: null,
                    selectedMood: null,
                    selectedClient: null,
                    audiences: [],
                    symptoms: [],
                    challenges: [],
                    instructions: [],
                    clients: [
                        { title: 'The Living Relationship', value: 'tlr' },
                        { title: 'The Momentum Institute', value: 'tmi' }
                    ],
                    tones: ['Compassionate', 'Empathetic', 'Empowering', 'Thought-provoking'],
                    moods: ['Reflective', 'Intimate', 'Emotionally charged', 'Optimistic']
                };
            },
            computed: {
                generatedPrompt() {
                    const instruction = this.selectedInstruction ? this.selectedInstruction.value : '___';
                    const audience = this.selectedAudience ? this.selectedAudience.value : '___';
                    const challenge = this.selectedChallenge ? this.selectedChallenge.value : '___';
                    const symptom = this.selectedSymptom ? this.selectedSymptom.value : '___';
                    const tone = this.selectedTone ? this.selectedTone : '___';
                    const mood = this.selectedMood ? this.selectedMood : '___';
                    return `Tone: ${tone}.\nMood: ${mood}.\nAudience: ${audience}.\nContext: ${challenge}.\nSymptom: ${symptom}.\nInstructions: ${instruction}`;
                }
            },
            methods: {
                clearSelections() {
                    this.selectedClient = null;
                    this.selectedAudience = null;
                    this.selectedChallenge = null;
                    this.selectedInstruction = null;
                    this.selectedSymptom = null;
                    this.selectedTone = null;
                    this.selectedMood = null;
                    this.saveSelections();
                    this.audiences = [];
                    this.symptoms = [];
                    this.challenges = [];
                    this.instructions = [];
                }, 
                saveSelections() {
                    localStorage.setItem('selectedClient', this.selectedClient);
                    localStorage.setItem('selectedAudience', JSON.stringify(this.selectedAudience));
                    localStorage.setItem('selectedChallenge', JSON.stringify(this.selectedChallenge));
                    localStorage.setItem('selectedInstruction', JSON.stringify(this.selectedInstruction));
                    localStorage.setItem('selectedSymptom', JSON.stringify(this.selectedSymptom));
                    localStorage.setItem('selectedTone', this.selectedTone);
                    localStorage.setItem('selectedMood', this.selectedMood);
                },
                loadSelections() {
                    const client = localStorage.getItem('selectedClient');
                    if (client) {
                        this.selectedClient = client;
                        this.loadClientData().then(() => {
                            this.selectedAudience = JSON.parse(localStorage.getItem('selectedAudience'));
                            this.selectedChallenge = JSON.parse(localStorage.getItem('selectedChallenge'));
                            this.selectedInstruction = JSON.parse(localStorage.getItem('selectedInstruction'));
                            this.selectedSymptom = JSON.parse(localStorage.getItem('selectedSymptom'));
                        });
                    }
                    this.selectedTone = localStorage.getItem('selectedTone');
                    this.selectedMood = localStorage.getItem('selectedMood');
                },
                async loadClientData() {
                    if (!this.selectedClient) return;

                    try {
                        const response = await fetch(`./data/${this.selectedClient}.json`);
                        const data = await response.json();

                        this.audiences = data.audiences.sort((a, b) => a.title.localeCompare(b.title));
                        this.symptoms = data.symptoms.sort((a, b) => a.title.localeCompare(b.title));
                        this.challenges = data.challenges.sort((a, b) => a.title.localeCompare(b.title));
                        this.instructions = data.instructions.sort((a, b) => a.title.localeCompare(b.title));
                    } catch (error) {
                        console.error('Error loading client data:', error);
                    }
                },
                copyToClipboard() {
                    const text = this.generatedPrompt;
                    navigator.clipboard.writeText(text).then(() => {
                        alert('Prompt copied to clipboard!');
                    }).catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
                }
            },
            created() {
                this.loadSelections();
            }
        });

    </script>

</body>

</html>
